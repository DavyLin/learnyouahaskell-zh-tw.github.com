<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <style>
            @import url(css/style.css);
            @import url(css/feedback.css);
        </style>
        <script src="js/jquery.js"></script>
        <script src="js/jquery.chili-2.2.js"></script>
        <script src="js/script.js"></script>
        <script src="js/html2canvas.js"></script>
        <script src="js/jsfeedback.js"></script>
        <script>
             ChiliBook.recipeFolder = "js/chili/";  
             ChiliBook.automaticSelector = "pre";
        </script>
        <script>
            $(function(){
                $('#feedback').click(function(){
                    $('body').feedback();
                })
            });
        </script>
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-32830659-1']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
        <title>來看看幾種Monad</title>
    </head>
    <body>
        <div id="header">
            <img id="beta" alt="beta" src="img/beta.png" />
        </div>

        <div id="main">
            <ul class="nav">
                <li class="left">  <img src="img/prv.png"></img><a href="functors-applicative-functors-and-monoids.html">Functors, Applicative Functors與Monoids</a></li>
                <li class="center"><a href="chapters.html">Index</a></li>
                <li class="right"> <a href="for-a-few-monads-more.html">再來看看更多Monad</a><img src="img/nxt.png"></img></li>
            </ul>
            <a name="來看看幾種Monad"></a><h1>來看看幾種Monad</h1><p>當我們第一次談到Functor的時候，我們了解到他是一個抽象概念，代表是一種可以被map over的值。然後我們再將其概念提升到Applicative Functor，他代表一種帶有context的型態，我們可以用函數操作他而且同時還保有他的context。</p><p>在這一章，我們會學到Monad，基本上他是一種加強版的Applicative Functor，正如Applicative Functor是Functor的加強版一樣。</p><p>我們介紹到Functor是因為我們觀察到有許多型態都可以被function給map over，了解到這個目的，便抽象化了<code>Functor</code>這個typeclass出來。但這讓我們想問：如果給定一個<code>a -> b</code>的函數以及<code>f a</code>的型態，我們要如何將函數map over這個型態而得到<code>f b</code>？我們知道要如何map over<code>Maybe a</code>，<code>[a]</code>以及<code>IO a</code>。我們甚至還知道如何用<code>a -> b</code>map over<code>r -> a</code>，並且會得到<code>r -> b</code>。要回答這個問題，我們只需要看<code>fmap</code>的型態就好了：</p><pre class="code">fmap :: (Functor f) => (a -> b) -> f a -> f b</pre><p>然後只要針對<code>Functor</code>instance撰寫對應的實做。</p><p>之後我們又看到一些可以針對Functor改進的地方，例如<code>a -> b</code>也被包在一個Functor value裡面呢？像是<code>Just (*3)</code>，我們要如何apply<code>Just 5</code>給他？如果我們不要apply<code>Just 5</code>而是<code>Nothing</code>呢？甚至給定<code>[(*2),(+4)]</code>，我們要如何apply他們到<code>[1,2,3]</code>呢？對於此，我們抽象出<code>Applicative</code>typeclass，這就是我們想要問的問題：</p><pre class="code">(<*>) :: (Applicative f) => f (a -> b) -> f a -> f b</pre><p>我們也看到我們可以將一個正常的值包在一個資料型態中。例如說我們可以拿一個<code>1</code>然後把他包成<code>Just 1</code>。或是把他包成<code>[1]</code>。也可以是一個I/O action會產生一個<code>1</code>。這樣包裝的function我們叫他做<code>pure</code>。</p><p>如我們說得，一個applicative value可以被看作一個有附加context的值。例如說，<code>'a'</code>只是一個普通的字元，但<code>Just 'a'</code>是一個附加了context的字元。他不是<code>Char</code>而是<code>Maybe Char</code>，這型態告訴我們這個值可能是一個字元，也可能什麼都沒有。</p><p>來看看<code>Applicative</code>typeclass怎樣讓我們用普通的function操作他們，同時還保有context：</p><pre class="code">ghci> (*) <$> Just 2 <*> Just 8  
Just 16  
ghci> (++) <$> Just "klingon" <*> Nothing  
Nothing  
ghci> (-) <$> [3,4] <*> [1,2,3]  
[2,1,0,3,2,1]</pre><p>所以我們可以視他們為aaplicative values，<code>Maybe a</code>代表可能會失敗的computation，<code>[a]</code>代表同時有好多結果的computation (non-deterministic computation)，而<code>IO a</code>代表會有side-effects的computation。</p><p>Monad是一個從Applicative functors很自然的一個演進結果。對於他們我們主要考量的點是：如果你有一個具有context的值<code>m a</code>，你能如何把他丟進一個只接受普通值<code>a</code>的函數中，並回傳一個具有context的值？也就是說，你如何套用一個型態為<code>a -> m b</code>的函數至<code>m a</code>？基本上，我們要求的函數是：</p><pre class="code">(>>=) :: (Monad m) => m a -> (a -> m b) -> m b</pre><p>如果我們有一個漂亮的值跟一個函數接受普通的值但回傳漂亮的值，那我們要如何要把漂亮的值丟進函數中？這就是我們使用Monad時所要考量的事情。我們不寫成<code>f a</code>而寫成<code>m a</code>是因為<code>m</code>代表的是<code>Monad</code>，但monad不過就是支援<code>>>=</code>操作的applicative functors。<code>>>=</code>我們稱呼他為bind。</p><p>當我們有一個普通值<code>a</code>跟一個普通函數<code>a -> b</code>，要套用函數是一件很簡單的事。但當你在處理具有context的值時，就需要多考慮些東西，要如何把漂亮的值餵進函數中，並如何考慮他們的行為，但你將會了解到他們其實不難。</p><a name="動手做做看: Maybe Monad"></a><h2>動手做做看: Maybe Monad</h2><p>現在對於什麼是Monad已經有了些模糊的概念，</p><p>我們來看看要如何讓這概念更具體一些。</p><p>不意外地，<code>Maybe</code>是一個Monad，</p><p>所以讓我們對於他多探討些，看看是否能跟我們所知的Monad概念結合起來。</p><a name="Monad type class"></a><h2>Monad type class</h2><a name="走鋼索"></a><h2>走鋼索</h2><a name="do表示法"></a><h2>do表示法</h2><a name="List Monad"></a><h2>List Monad</h2><a name="Monad laws (單子律)"></a><h2>Monad laws (單子律)</h2>
            <ul class="nav">
                <li class="left">  <img src="img/prv.png"></img><a href="functors-applicative-functors-and-monoids.html">Functors, Applicative Functors與Monoids</a></li>
                <li class="center"><a href="chapters.html">Index</a></li>
                <li class="right"> <a href="for-a-few-monads-more.html">再來看看更多Monad</a><img src="img/nxt.png"></img></li>
            </ul>
        </div>
        <div id="footer">
        </div>
        <div id="feedback">Send feedback</div>
    </body>
</html>
